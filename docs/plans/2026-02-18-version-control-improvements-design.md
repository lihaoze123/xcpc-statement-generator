# 版本管理功能改进设计

> **Date:** 2026-02-18
> **Status:** Approved

## 目标

改进版本管理的用户引导和增强核心功能，提升用户体验。

---

## 1. 空状态引导改进

### 当前问题
版本列表为空时，只显示"暂无版本记录"，用户不知道可以做什么。

### 改进方案
- 添加引导卡片，说明版本管理的作用
- 提供"保存第一个版本"的快捷按钮
- 显示简单的操作指引

### UI 设计
```
┌─────────────────────────────────────────────┐
│  📋 版本管理                                 │
│  保存比赛的各个版本，随时恢复和对比           │
├─────────────────────────────────────────────┤
│  🦶 还没有版本记录                           │
│                                             │
│  保存第一个版本，记录当前的比赛内容           │
│                                             │
│  [+ 保存当前版本]                           │
└─────────────────────────────────────────────┘
```

---

## 2. 版本预览功能

### 当前问题
用户需要先恢复版本才能查看内容，不够便捷。

### 改进方案
- 点击版本卡片可以展开/折叠预览详情
- 预览内容包括：
  - 版本基本信息（名称、描述、创建时间）
  - 包含的题目列表（题号、题名）
  - 可以展开查看题目内容预览（只读）
- 操作按钮始终可见：恢复、删除、对比选择

### UI 设计
```
┌─────────────────────────────────────────────┐
│  ▼ v1.0 - 初始版本                    恢复  │
│    2026-02-18 10:30                         │
│    包含 3 道题目                             │
├─────────────────────────────────────────────┤
│  📝 题目预览                                 │
│  ├─ A. 两数之和                              │
│  ├─ B. 排序问题                             │
│  └─ C. 图论基础                             │
└─────────────────────────────────────────────┘
```

---

## 3. 从版本创建分支

### 当前问题
创建新分支时只能是空分支，无法基于现有版本。

### 改进方案
- 创建分支时可以选择：
  - 从空白创建（当前行为）
  - 基于某个现有版本创建
- 分支列表显示：
  - 分支名称
  - 当前版本名称
  - 版本数量

### UI 设计
```
┌─ 新建分支 ─────────────────────────────────┐
│  分支名称: [draft-B                     ]  │
│                                             │
│  基于: ○ 空白                               │
│       ○ 从版本创建                          │
│         └─ 选择版本: [v1.0            ▼]   │
│                                             │
│        [取消]  [创建]                        │
└─────────────────────────────────────────────┘
```

---

## 架构

### 数据模型扩展
```typescript
interface Branch {
  id: string;
  name: string;
  createdAt: number;
  currentVersionId: string;
  baseVersionId?: string;  // 新增：基于的版本
}
```

### 组件变更
- VersionManager: 添加展开/折叠、预览功能
- 空状态组件：添加引导文案和快捷按钮
- 新建分支弹窗：添加基于版本的选择

---

## 实现顺序

1. 空状态引导改进
2. 版本预览功能
3. 从版本创建分支
